<!DOCTYPE html> 
<html> 
	<head> 
	<title>Forest Finder</title> 
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>
    <script type="text/javascript" src="http://static.stackmob.com/js/json2-min.js"></script>
    <script type="text/javascript" src="http://static.stackmob.com/js/underscore-1.3.3-min.js"></script>
    <script type="text/javascript" src="stackmob-js-0.2.1-min.js"></script>
    <script type="text/javascript" src="backbone-0.9.2-min.js"></script>    
    
    	<meta name="viewport" content="width=device-width, initial-scale=1"> 
       
	<link rel="stylesheet" href="jquery.mobile-1.0.1.min.css" />
	<script src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
<script src="jquery.mobile-1.0.1.min.js"></script>

</head> 
<body> 

<div data-role="page" data-title="Site Page" id="sitepage">
<script>

    /* <![CDATA[ */
      //Remember to initialize StackMob before you use other StackMob functionality.
        StackMob.init({
        appName: "trevsapp2",
        clientSubdomain: "trevorclowry",
        apiVersion: 0
      });
    /* ]]> */

      var Recreationsite = StackMob.Model.extend({
        schemaName: 'recreationsite'  //schemaName must be lowercase
      });
      
        var Recreationsites = StackMob.Collection.extend({
        model: Recreationsite
      });
        //var Todos = StackMob.Collection.extend({
        //model: Todo
      //});
		
		
</script>
<script>

function getUrlVars()
{
    var vars = [], hash;
    var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
    for(var i = 0; i < hashes.length; i++)
    {
        hash = hashes[i].split('=');
        vars.push(hash[0]);
        vars[hash[0]] = hash[1];
    }
    return vars;
}

function getSiteInfo()
{

var siteparam = getUrlVars()["siteid"];
 var smQuery = new StackMob.Collection.Query();
  //get all Todo items of high priority, order by createddate in ascending order.
  //Get the first 5 results.
  smQuery.equals('recreationsite_id', siteparam).orderAsc('createddate'); //you can chain query parameters
  smQuery.setRange(0,0); //or add them individually
  
   var siteinfo = new Recreationsites();
   
  siteinfo.query(smQuery, {
				 
    success: function(collection) {
		

		siteinfo.each(function(Recreationsitez) {
							   
							   
							   if (Recreationsitez.get("image")!=""){ 
bigimage = 'http://www.coillteoutdoors.ie/uploads/tx_r3coillterecreationsites/' + Recreationsitez.get("image");	
}

							   
			siteinfolistString =""; 
		
			siteinfolistString += '<tr><td  valign="top"><strong>Site Name</strong></td></tr><tr><td>'+ Recreationsitez.get('sitename') + '</td></tr>'; 
  siteinfolistString += '<tr><td  valign="top"><strong>County</strong></td></tr><tr><td>'+ Recreationsitez.get('county') + '</td></tr>'; 
if (Recreationsitez.get("image")!=""){ siteinfolistString += '<tr><td  valign="top"><strong>Image</strong></td></tr><tr><td><img src="' + bigimage + '" /></td></tr>';}  
if (Recreationsitez.get("location")!=""){ siteinfolistString += '<tr><td  valign="top"><strong>Location</strong></td></tr><tr><td>'+ Recreationsitez.get('location') + '</td></tr>'; }
if (Recreationsitez.get("googlemap")!=""){ siteinfolistString += '<tr><td  valign="top"><strong>Google Map</strong></td></tr><tr><td>'+ Recreationsitez.get('googlemap') + '</td></tr>'; }
if (Recreationsitez.get("direction")!=""){ siteinfolistString += '<tr><td  valign="top"><strong>Directions</strong></td></tr><tr><td>'+ Recreationsitez.get('direction') + '</td></tr>'; }
if (Recreationsitez.get("grid_ref")!=""){ siteinfolistString += '<tr><td  valign="top"><strong>Grid Ref</strong></td></tr><tr><td>'+ Recreationsitez.get('grid_ref') + '</td></tr>'; }
if (Recreationsitez.get("os_map")!=""){ siteinfolistString += '<tr><td  valign="top"><strong>OS Map</strong></td></tr><tr><td>'+ Recreationsitez.get('os_map') + '</td></tr>'; }
if (Recreationsitez.get("trails_map")!=""){ siteinfolistString += '<tr><td  valign="top"><strong>Trails Map</strong></td></tr><tr><td><a href="http://www.coillteoutdoors.ie/uploads/tx_r3coillterecreationsites/'+ Recreationsitez.get('trails_map') + '">Download trails map (PDF)</a></td></tr>';}

if (Recreationsitez.get("details")!=""){ siteinfolistString += '<tr><td  valign="top"><strong>Details</strong></td></tr><tr><td>'+ Recreationsitez.get('details') + '</td></tr>';}
if (Recreationsitez.get("activities")!=""){ siteinfolistString += '<tr><td  valign="top"><strong>Activities</strong></td></tr><tr><td>'+ Recreationsitez.get('activities') + '</td></tr>'; }
if (Recreationsitez.get("features")!=""){ siteinfolistString += '<tr><td  valign="top"><strong>Features</strong></td></tr><tr><td>'+ Recreationsitez.get('features') + '</td></tr>'; }


if (Recreationsitez.get("num_car_spaces")!=""){ siteinfolistString += '<tr><td  valign="top"><strong>Number Car Spaces</strong></td></tr><tr><td>'+ Recreationsitez.get('num_car_spaces') + '</td></tr>'; }
if (Recreationsitez.get("car_park_closes")!=""){ siteinfolistString += '<tr><td  valign="top"><strong>Car Park Closes</tr><tr>'+ Recreationsitez.get('car_park_closes') + '</td></tr>';} 
if (Recreationsitez.get("car_park_opens")!=""){ siteinfolistString += '<tr><td  valign="top"><strong>Car Park Opens</strong></td></tr><tr><td>'+ Recreationsitez.get('car_park_opens') + '</td></tr>'; }
if (Recreationsitez.get("parking_fee")!=""){ siteinfolistString += '<tr><td  valign="top"><strong>Parking Fee</strong></td></tr><tr><td>'+ Recreationsitez.get('parking_fee') + '</td></tr>'; }

if (Recreationsitez.get("contact_name")!=""){ siteinfolistString += '<tr><td  valign="top"><strong>Contact Name</strong></td></tr><tr><td>'+ Recreationsitez.get('contact_name') + '</td></tr>'; }
if (Recreationsitez.get("contact_phone")!=""){ siteinfolistString += '<tr><td  valign="top"><strong>Contact Phone</strong></td></tr><tr><td><tel>'+ Recreationsitez.get('contact_phone') + '</tel></td></tr>';} 
if (Recreationsitez.get("contactemail")!=""){ siteinfolistString += '<tr><td  valign="top"><strong>Contact Email</strong></td></tr><tr><td><a href="mailto:'+ Recreationsitez.get('contactemail') + '">' + Recreationsitez.get('contactemail') + '</a></td></tr>'; }

			
			
			console.debug(siteinfo.toJSON());
			$("#siteinfolist").append(siteinfolistString); 
			$('table').listview('refresh');  $("ul").empty()
			
			 }
		 
	)}
  
   });
		
}

$( '#sitepage' ).live( 'pageshow',function(event){



getSiteInfo();
		
		
 });

</script>

	<div data-role="header" >
    <a href="index.html" >Back</a>
		<h1>Forest Finder</h1>
	</div><!-- /header -->

	<div data-role="content" >	
    <ul >

</ul>


    <style>
			table { width:100%; }
			table caption { text-align:left;  }
			table thead th { text-align:left; border-bottom-width:1px; border-top-width:1px; }
			table th, td { text-align:left; padding:6px;} 
		</style>
    
     <table data-role="listview" id="siteinfolist">
	</table>

	
    
	</div><!-- /content -->

</div><!-- /page -->

</body>
</html>